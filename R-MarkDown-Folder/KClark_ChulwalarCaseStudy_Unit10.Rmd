---
title: "Case Study - 10"
author: "Karen Clark"
date: "July 27, 2016"
output:
   html_document: 
    toc: true
    number_sections: true
---

#Import Data for Chulwahlar Forecasting Exports
##Preparing for Import 

``` {r, echo=FALSE}
# load 'fpp' package in order to obtain the forecasting functions

library(fpp)
library(fmsb)
library(xtable)

#load 'tcltk' for pause function

library(tcltk)

mywait <- function() {
    tt <- tktoplevel()
    tkpack( tkbutton(tt, text='Continue', command=function()tkdestroy(tt)),
        side='bottom')
    tkbind(tt,'<Key>', function()tkdestroy(tt) )

    tkwait.window(tt)
}
```
#Import Data set

Imported the Observed data set (ImportedAsIsDataChulwalar.csv)

``` {r, echo=FALSE, results='hide'}
#importing ImportedAsIsDataChulwalar.csv
ImportedAsIsData <- read.csv('C:\\Users\\kclark.RXDATA.000\\Personal\\SMU\\Doing Data Science MSDS 6306\\Unit 10 Case Study\\ChulwalarCase\\ImportedAsIsDataChulwalar.csv', header = F, sep=";", fill = T) 
```
Imported the Plan Data set (ImportedPlanDataChulwalar.csv)
``` {r, echo=FALSE, results='hide'}
#importing ImportedPlanDataChulwalar.csv
ImportedPlanData <- read.csv('C:\\Users\\kclark.RXDATA.000\\Personal\\SMU\\Doing Data Science MSDS 6306\\Unit 10 Case Study\\ChulwalarCase\\ImportedPlanDataChulwalar.csv', header = F, sep=";", fill = T) 
```

Imported the Indicator Data Set (ImportedIndicatorsChulwalar.csv)

```{r, echo=FALSE, results='hide'}
#importing ImportedIndicatorsChulwalar.csv
ImportedIndicators <- read.csv('C:\\Users\\kclark.RXDATA.000\\Personal\\SMU\\Doing Data Science MSDS 6306\\Unit 10 Case Study\\ChulwalarCase\\ImportedIndicatorsChulwalar.csv', header = F, sep=";", fill = T) 
```

#Data Transformations

Data Vectors were created with partial data sets for data analysis and forecasting.

As Is Data Set Vectors Created:

  1. TotalAsIsVector
  2. TotalEtelAsIsVector
  3. BlueEtelAsIsVector
  4. RedEtelAsIsVector
  5. YearAsIsVector
  6. TotalAsIsVector_2014
  
Plan Data Vectors Created:

  1. PlanVector
  2. TotalEtelPlanVector
  3. BlueEtelPlanVector
  4. RedEtelPlanVector
  5. YearPlanVector
  6. PlanVector_2014
  

```{r, echo=FALSE}
#In order to be able to work with the partial data sets during the data analysis and forcasting, the data sets need to be split into individual vectors 

TotalAsIsVector <- c(ImportedAsIsData [2:13,2],ImportedAsIsData [2:13,3],ImportedAsIsData [2:13,4],ImportedAsIsData [2:13,5],ImportedAsIsData [2:13,6],ImportedAsIsData [2:13,7])
EfakAsIsVector <- c(ImportedAsIsData [16:27,2],ImportedAsIsData [16:27,3],ImportedAsIsData [16:27,4],ImportedAsIsData [16:27,5],ImportedAsIsData [16:27,6],ImportedAsIsData [16:27,7])
WugeAsIsVector <- c(ImportedAsIsData [30:41,2],ImportedAsIsData [30:41,3],ImportedAsIsData [30:41,4],ImportedAsIsData [30:41,5],ImportedAsIsData [30:41,6],ImportedAsIsData [30:41,7])
TotalEtelAsIsVector <- c(ImportedAsIsData [44:55,2],ImportedAsIsData [44:55,3],ImportedAsIsData [44:55,4],ImportedAsIsData [44:55,5],ImportedAsIsData [44:55,6],ImportedAsIsData [44:55,7])
BlueEtelAsIsVector <- c(ImportedAsIsData [58:69,2],ImportedAsIsData [58:69,3],ImportedAsIsData [58:69,4],ImportedAsIsData [58:69,5],ImportedAsIsData [58:69,6],ImportedAsIsData [58:69,7])
RedEtelAsIsVector <- c(ImportedAsIsData [72:83,2],ImportedAsIsData [72:83,3],ImportedAsIsData [72:83,4],ImportedAsIsData [72:83,5],ImportedAsIsData [72:83,6],ImportedAsIsData [72:83,7])
YearAsIsVector <- c(ImportedAsIsData [86,2],ImportedAsIsData [86,3],ImportedAsIsData [86,4],ImportedAsIsData [86,5],ImportedAsIsData [86,6],ImportedAsIsData [86,7])
TotalAsIsVector_2014 <- c(ImportedAsIsData[2:13,8])

PlanVector <- c(ImportedPlanData[2:13,2],ImportedPlanData[2:13,3],ImportedPlanData[2:13,4],ImportedPlanData[2:13,5],ImportedPlanData[2:13,6],ImportedPlanData[2:13,7])
EfakPlanVector <- c(ImportedPlanData[16:27,2],ImportedPlanData[16:27,3],ImportedPlanData[16:27,4],ImportedPlanData[16:27,5],ImportedPlanData[16:27,6],ImportedPlanData[16:27,7])
WugePlanVector <- c(ImportedPlanData[30:41,2],ImportedPlanData[30:41,3],ImportedPlanData[30:41,4],ImportedPlanData[30:41,5],ImportedPlanData[30:41,6],ImportedPlanData[30:41,7])
TotalEtelPlanVector <- c(ImportedPlanData[44:55,2],ImportedPlanData[44:55,3],ImportedPlanData[44:55,4],ImportedPlanData[44:55,5],ImportedPlanData[44:55,6],ImportedPlanData[44:55,7])
BlueEtelPlanVector <- c(ImportedPlanData[58:69,2],ImportedPlanData[58:69,3],ImportedPlanData[58:69,4],ImportedPlanData[58:69,5],ImportedPlanData[58:69,6],ImportedPlanData[58:69,7])
RedEtelPlanVector <- c(ImportedPlanData[72:83,2],ImportedPlanData[72:83,3],ImportedPlanData[72:83,4],ImportedPlanData[72:83,5],ImportedPlanData[72:83,6],ImportedPlanData[72:83,7])
YearPlanVector <- c(ImportedPlanData[86,2],ImportedPlanData[86,3],ImportedPlanData[86,4],ImportedPlanData[86,5],ImportedPlanData[86,6],ImportedPlanData[86,7])
PlanVector_2014 <- c(ImportedPlanData[2:13,8])
```
The Vectors were then converted into Time Series data sets.

Below is a review of the time series data sets created for the following
Total As Is Data, Total Etel Flower As Is, Blue Etel Flower As Is, Red Etel Flower As IS, Year As IS, and Total As Is for 2014.

```{r, echo=FALSE}
# The data is saved as a vector and needs to be converted into a time series

TotalAsIs<- ts(TotalAsIsVector , start=c(2008,1), end=c(2013,12), frequency=12)
#EfakAsIs <- ts(EfakAsIsVector , start=c(2008,1), end=c(2013,12), frequency=12)
#WugeAsIs <- ts(WugeAsIsVector, start=c(2008,1), end=c(2013,12), frequency=12)
TotalEtelAsIs<- ts(TotalEtelAsIsVector, start=c(2008,1), end=c(2013,12), frequency=12)
BlueEtelAsIs <- ts(BlueEtelAsIsVector, start=c(2008,1), end=c(2013,12), frequency=12)
RedEtelAsIs <- ts(RedEtelAsIsVector, start=c(2008,1), end=c(2013,12), frequency=12)
YearAsIs <- ts(YearAsIsVector, start=c(2008,1), end=c(2013,12), frequency=12)
TotalAsIs_2014 <- ts(TotalAsIsVector_2014, start=c(2014,1), end=c(2014,12), frequency=12)
```

Total As Is:
```{r,echo=FALSE}
TotalAsIs
```

Total Etel Flower As Is:
```{r,echo=FALSE}
TotalEtelAsIs
```

Blue Etel Flower As Is:
```{r,echo=FALSE}
BlueEtelAsIs 
```

Red Etel Flower As Is:
```{r,echo=FALSE}
RedEtelAsIs 
```

Year As Is:
```{r,echo=FALSE}
YearAsIs
```

Total As Is 2014:
```{r, echo=FALSE}
TotalAsIs_2014

```


Below is a review of the time series data sets created for the following
Total Plan, Total Etel Flower Plan, Blue Etel Flower Plan, Red Etel Flower Plan, Year Plan, and Total Plan for 2014.
```{r, echo=FALSE}
TotalPlan <- ts(PlanVector , start=c(2008,1), end=c(2013,12), frequency=12)
#EfakPlan <- ts(EfakPlanVector, start=c(2008,1), end=c(2013,12), frequency=12)
#WugePlan <- ts(WugePlanVector, start=c(2008,1), end=c(2013,12), frequency=12)
TotalEtelPlan <- ts(TotalEtelPlanVector, start=c(2008,1), end=c(2013,12), frequency=12)
BlueEtelPlan <- ts(BlueEtelPlanVector, start=c(2008,1), end=c(2013,12), frequency=12)
RedEtelPlan <- ts(RedEtelPlanVector, start=c(2008,1), end=c(2013,12), frequency=12)
YearPlan <- ts(YearPlanVector, start=c(2008,1), end=c(2013,12), frequency=12)
TotalPlan_2014 <- ts(PlanVector_2014, start=c(2014,1), end=c(2014,12), frequency=12)
```

Total Plan:
```{r,echo=FALSE}
TotalPlan
```

Total Etel Flower Plan:
```{r,echo=FALSE}
TotalEtelPlan
```

Blue Etel Flower Plan:
```{r,echo=FALSE}
BlueEtelPlan
```

Red Etel Flower Plan;
```{r,echo=FALSE}
RedEtelPlan
```

Year Plan:
```{r,echo=FALSE}
YearPlan
```


Total Plan for 2014:
```{r,echo=FALSE}
TotalPlan_2014
```
#Data Analysis on the Blue Etel Flower

##Plots of As Is data:

```{r, echo=FALSE}
#plot the total Etel flower data sales versus the Blue Etel sales
par(mfrow=c(3,2))
plot(TotalAsIs, col="black", main="Total As Is")
plot(TotalEtelAsIs, col="green",main="Total Current Etel Flower Exports", ylab="All Etel Flowers")
plot(BlueEtelAsIs, col="orange", main="Total Current Blue Etel Flower Exports", ylab="Blue Etel Flowers")
plot(RedEtelAsIs, col="purple", main="Total Current Red Etel Flower Exports", ylab="Red Etel Flowers")
```

The Blue Etel sales account for a large majority of the Etel flower sales.  The Red Etel had greater sales in 2014 where the Blue Etel faltered.  The sales plot displays seasonality.  Sales appear to have dropped drastically between 2010 and 2011 for all Etel flowers and could possibly account for weather or a bad growth season.

##Plots of Plan Data:

```{r,echo=FALSE}
par(mfrow=c(3,2))
plot(TotalPlan , col="black", main="Total Plan")
plot(TotalEtelPlan, col="green",main="Total Etel Flower Plan")
plot(BlueEtelPlan, col="orange", main="Blue Etel Flower Plan")
plot(RedEtelPlan, col="purple", main="Red Etel Flower Plan")
```


Since the basic plots of the Etel flowers that separate seasonality and trend. Below are some plots that examine the seasonality a little more in depth but add trending. The remainder graph basically identifies any noise in the data that might skew the seasonality or trend data.  

The plots below are based on the time series data sets instead of the current data data sets.

```{r, echo=FALSE}
# The time series can be analysed using the stl function in order to seperate
# the trend, seasonality and remainder (remaining coincidential) components from
# one another.
TotalEtelAsIs_stl <- stl(TotalEtelAsIs, s.window=5)
BlueEtelAsIs_stl <- stl(BlueEtelAsIs , s.window=5)
RedEtelAsIs_stl <- stl(RedEtelAsIs , s.window=5)
```


```{r, echo=FALSE}

par(mfrow=c(3,2))
plot(TotalEtelAsIs_stl, col="purple", main="Total Etel Flower Export Seasonality and Trends")
```

``` {r, echo=FALSE}
plot(BlueEtelAsIs_stl, col="blue", main="Total Blue Etel Flower Export Seasonality and Trends")
```

``` {r, echo=FALSE}

plot(RedEtelAsIs_stl, col="red", main="Total Red Etel Flower Export Seasonality and Trends")

```

When viewing the overall Etel Flower Exports by seasonal and inherit trends, you can see that the seasonal panel is only slightly larger than that on the data panel, which indicates the seasonal signal is largely relative to the variation in the data.  When looking at the trend plot it is much larger than the seasonal plot, which indicates the variation attributed to the trend is much smaller than the seasonal component.  The overall export data of both Etel flowers and each individual flower plot does not exhibit a trend.

##Modify the Seasonal data to view it at a monthly level

Even though the above plots do not indicate that the seasonal and trend plot look identical, breaking the data down by month will an alternative view.

```{r,echo=FALSE}
#plot the seasonality by month to see if a trend is present
monthplot(TotalEtelAsIs_stl$time.series[,"seasonal"], main="Total Etel Flower Exports", ylab="Seasonal")
monthplot(BlueEtelAsIs_stl$time.series[,"seasonal"], main="Total Blue Etel Flower Exports", ylab="Seasonal")
monthplot(RedEtelAsIs_stl$time.series[,"seasonal"], main="Total Red Etel Flower Exports", ylab="Seasonal")
```

All three plots display a drop in exports in July and a sharp increase in exports in September.  The monthly plots do display a trend associated with seasonality that is driven by the temperature in Chulwalar.

##Viewing Correlations between the As Is data and the Plan:

Correlation between the Total As Is data and the Total Plan:
```{r, echo=FALSE}
cor(TotalAsIs, TotalPlan)
```

Correlation between the Total Etel Flower As Is data and the Total Etel Plan:
```{r,echo=FALSE}
cor(TotalEtelAsIs, TotalEtelPlan)
```

Correlation between the Total Blue Etel Flower As Is data and the Total Blue Etel Plan:
```{r,echo=FALSE}
cor(BlueEtelAsIs , BlueEtelPlan)
```

Correlation between the Total Red Etel Flower As Is data and the Total Red Etel Plan:
```{r,echo=FALSE}
cor(RedEtelAsIs , RedEtelPlan)
```

There is a strong correlation between the current As Is data for the Etel flower and the plan data for the Etel Flower.  The Blue Etel flower As Is data and Plan correlation is not as strong as the Red Etel flowers.

##View the Differences between the As Is data and the Plan data

This analysis is to make sure the plan is accurate and that the data is identical.

```{r, echo=FALSE}
# The results show a very high planning accuracy. 

TotalAsIs_lm <- lm(TotalAsIs ~ TotalPlan , data = TotalAsIs)

```

View of the Total As Is differences:
```{r, echo=FALSE}

summary(TotalAsIs_lm)


```
```{r, echo=FALSE}

TotalAsIs_tslm <- tslm(TotalAsIs ~ TotalPlan )
```

View of the Total As Is Time Series data differences 
```{R, echo=FALSE}
summary(TotalAsIs_tslm)
```

The As Is data and the As Is Time Series data match the plan data.  The adjusted R square for both equal 0.8411.
```{r, echo=FALSE}
TotalEtelAsIs_lm <- lm(TotalEtelAsIs ~ TotalEtelPlan , data = TotalEtelAsIs)
```

View the Total Etel Flower As Is Data:
```{r, echo=FALSE}
summary(TotalEtelAsIs_lm)
```

The Etel Flower As Is data and the Etel Flower As Is Time Series data match the plan data for the Etel Flower.  The adjusted R square for both equal 0.8367.
```{r, echo=FALSE}
TotalEtelAsIs_tslm <- tslm(TotalEtelAsIs ~ TotalEtelPlan )
```

View the Total Etel Flower As Is Time Series data Differences:
```{r,echo=FALSE}
summary(TotalEtelAsIs_tslm)
```


###Correlation of External Indicators

The following Correlation factors were examined to see if there was any impact on the total Etel Flower exports.

1. Current Export Price Index - the correlation was 0.339713. Some correlation but not enough to impact the total Etel Flower Exports

2. Birth - there is a negative correlation (-0.1504242), so if births decrease the export of Etel flowers decrease.


```{r, echo=FALSE, comment="", echo=FALSE}
#checking the correlation between Etel Flower exports and CEPI
#some but not enough
CEPIVector <- c(ImportedIndicators[2:13,2],ImportedIndicators[2:13,3],ImportedIndicators[2:13,4],ImportedIndicators[2:13,5],ImportedIndicators[2:13,6],ImportedIndicators[2:13,7])
CEPI <- ts(CEPIVector , start=c(2008,1), end=c(2013,12), frequency=12)
```
```{r, results='hide', echo=FALSE}
#plot(CEPI, main="CEPI")
cor(TotalEtelAsIs, CEPI)
cor(BlueEtelAsIs , CEPI)
cor(RedEtelAsIs , CEPI)
```
```{r, results='hide', echo=FALSE}
#checking to see if there is a correlation between the Etel flower exports and births
BirthsVector <- c(ImportedIndicators[44:55,2],ImportedIndicators[44:55,3],ImportedIndicators[44:55,4],ImportedIndicators[44:55,5],ImportedIndicators[44:55,6],ImportedIndicators[44:55,7])
Births <- ts(BirthsVector, start=c(2008,1), end=c(2013,12), frequency=12)
plot(Births, main="Births")
```
```{r,  results='hide',echo=FALSE}
#There is no correlation between births and exports for Etel Flowers
#plot(Births, main="Births")
cor(TotalEtelAsIs, Births)
cor(BlueEtelAsIs , Births)
cor(RedEtelAsIs , Births)
```

3. Exports from Urbano - there is a slight correlation (0.3182532) but not enough to impact the total Etel Flower exports. 

4. Independence Day Presents Indicator - there is a small correlation (0.287213) but not enough to impact the total Etel Flower Exports.

```{r,echo=FALSE}
#Check to see if therre is a correlation between the Etel flower exports and yearly exports from urbano.  There is a very small correlation between Urbano exports and the Red Etel flower
# Yearly exports from Urbano
UrbanoExportsVector <- c(ImportedIndicators[72:83,2],ImportedIndicators[72:83,3],ImportedIndicators[72:83,4],ImportedIndicators[72:83,5],ImportedIndicators[72:83,6],ImportedIndicators[72:83,7])
UrbanoExports <- ts(UrbanoExportsVector, start=c(2008,1), end=c(2013,12), frequency=12)
```
```{r,  results='hide',echo=FALSE}
#plot(UrbanoExports, main="UrbanoExports")
cor(TotalEtelAsIs, UrbanoExports)
cor(BlueEtelAsIs , UrbanoExports)
cor(RedEtelAsIs , UrbanoExports)
```
```{r, echo=FALSE}
#checking to see if there is a correlation between the buying of Independence day presents and the exports for Etel flowers
# Proposed spending for Independence day presents
IndependenceDayPresentsVector <- c(ImportedIndicators[156:167,2],ImportedIndicators[156:167,3],ImportedIndicators[156:167,4],ImportedIndicators[156:167,5],ImportedIndicators[156:167,6],ImportedIndicators[156:167,7])
IndependenceDayPresents <- ts(IndependenceDayPresentsVector, start=c(2008,1), end=c(2013,12), frequency=12)
```
```{r,  results='hide',echo=FALSE}
#There is no correclation seen
#plot(IndependenceDayPresents, main="IndependenceDayPresents")
cor(TotalEtelAsIs, IndependenceDayPresents)
cor(BlueEtelAsIs , IndependenceDayPresents)
cor(RedEtelAsIs , IndependenceDayPresents)
```

5. Temperature - there is a negative correlation between the average temperature in chulwalar and the exports of the Etel flower.  In colder months exports increase and decrease in the warmer months.  The correlation of Total Etel flower exports and temperatur is -0.453138.

```{r, echo=FALSE}
# Average monthly temperatures in Chulwalar

TemperatureVector <- c(ImportedIndicators[30:41,2],ImportedIndicators[30:41,3],ImportedIndicators[30:41,4],ImportedIndicators[30:41,5],ImportedIndicators[30:41,6],ImportedIndicators[30:41,7])
Temperature <- ts(TemperatureVector, start=c(2008,1), end=c(2013,12), frequency=12)
```
```{r, echo=FALSE}
plot(Temperature, main="Temperature")
```

```{r, echo=FALSE, results='hide'}
#check the correlation between Etel Flower Exports and the temperature in Chulwalar
cor(TotalEtelAsIs, Temperature)
cor(BlueEtelAsIs , Temperature)
cor(RedEtelAsIs , Temperature)
```

6. Satisfaction Index - there is only a slight correlation between the overall satisfaction index and the export of Etel Flowers. The correlation value was 0.2865672.

```{r, results='hide', echo=FALSE}
#monthly Satisfaction index
SIExternVector <- c(ImportedIndicators[58:69,2],ImportedIndicators[58:69,3],ImportedIndicators[58:69,4],ImportedIndicators[58:69,5],ImportedIndicators[58:69,6],ImportedIndicators[58:69,7])
SIExtern <- ts(SIExternVector, start=c(2008,1), end=c(2013,12), frequency=12)
plot(SIExtern, main="SIExtern")
```
```{r, results='hide',echo=FALSE}
cor(TotalEtelAsIs, SIExtern)
cor(BlueEtelAsIs , SIExtern)
cor(RedEtelAsIs , SIExtern)
```

```{r, results='hide', echo=FALSE}
# Yearly number of Globalisation Party members in Chulwalar
GlobalisationPartyMembersVector <- c(ImportedIndicators[86:97,2],ImportedIndicators[86:97,3],ImportedIndicators[86:97,4],ImportedIndicators[86:97,5],ImportedIndicators[86:97,6],ImportedIndicators[86:97,7])
GlobalisationPartyMembers <- ts(GlobalisationPartyMembersVector, start=c(2008,1), end=c(2013,12), frequency=12)
plot(GlobalisationPartyMembers, main="GlobalisationPartyMembers")
```

7. Yearly number of Globalisation Party members in Chulwalar - there is not a big enough correlation (0.2994635) to impact the exports of the Etel Flower.

```{r,results='hide', echo=FALSE}
cor(TotalEtelAsIs, GlobalisationPartyMembers)
cor(BlueEtelAsIs , GlobalisationPartyMembers)
cor(RedEtelAsIs , GlobalisationPartyMembers)
```

8. Monthly Average Export Price Index in chulwalar - there is not a big enough correlatin (0.3035506) to impact the exports of the Etel Flower. One thought is that continue growth has a postive affect on exports.
```{r,echo=FALSE}
# Monthly Average Export Price Index for Chulwalar
AEPIVector <- c(ImportedIndicators[100:111,2],ImportedIndicators[100:111,3],ImportedIndicators[100:111,4],ImportedIndicators[100:111,5],ImportedIndicators[100:111,6],ImportedIndicators[100:111,7])
AEPI <- ts(AEPIVector, start=c(2008,1), end=c(2013,12), frequency=12)
```
```{r, results='hide', echo=FALSE}
plot(AEPI, main="Average Export Price Index", ylab = "Average Export Price Index")

#Check the correlation between Etel Flower Exports an PPI in Chulwalar
cor(TotalEtelAsIs, AEPI)
cor(BlueEtelAsIs , AEPI)
cor(RedEtelAsIs , AEPI)
```


9. Monthly Producer Price Index (PPI) for Etel in Chulwalar - there is not a big enough correlation (0.3374707) to impact the exports of the Etel Flower.

```{r, echo=FALSE}
PPIEtelVector <- c(ImportedIndicators[114:125,2],ImportedIndicators[114:125,3],ImportedIndicators[114:125,4],ImportedIndicators[114:125,5],ImportedIndicators[114:125,6],ImportedIndicators[114:125,7])
PPIEtel <- ts(PPIEtelVector, start=c(2008,1), end=c(2013,12), frequency=12)

```
```{r, results='hide', echo=FALSE}
plot(PPIEtel, main="Producer Price Index for the Etel Flower", ylab = "PPI for Etel Flower")

#Check the correlation between PPI for Etel Flowers
cor(TotalEtelAsIs, PPIEtel)
cor(BlueEtelAsIs , PPIEtel)
cor(RedEtelAsIs , PPIEtel)
```


10. National Holidays - there is a negative correlation (-0.01081446) between National Holidays and the exports of Etel flowers.  Individuals may export more Etel flowers for National holidays then other days.

```{r, echo=FALSE}
#National Holiday vector
NationalHolidaysVector <- c(ImportedIndicators[170:181,2],ImportedIndicators[170:181,3],ImportedIndicators[170:181,4],ImportedIndicators[170:181,5],ImportedIndicators[170:181,6],ImportedIndicators[170:181,7])
NationalHolidays <- ts(NationalHolidaysVector, start=c(2008,1), end=c(2013,12), frequency=12)
```
```{r, echo=FALSE}
#plot National Holiday trend for exports
plot(NationalHolidays, main="National Holidays")
```
```{r, results='hide', echo=FALSE}
#Correlation with Etel Flower Exports
cor(TotalEtelAsIs, NationalHolidays)
cor(BlueEtelAsIs , NationalHolidays)
cor(RedEtelAsIs , NationalHolidays)
```


11. The Total value of All companies in Chulwalar - there is not a big enough correlatin (0.3035506) to impact the exports of the Etel Flower.
```{r, echo=FALSE}
# Chulwalar Index (Total value of all companies in Chulwalar)
ChulwalarIndexVector <- c(ImportedIndicators[128:139,2],ImportedIndicators[128:139,3],ImportedIndicators[128:139,4],ImportedIndicators[128:139,5],ImportedIndicators[128:139,6],ImportedIndicators[128:139,7])
ChulwalarIndex <- ts(ChulwalarIndexVector, start=c(2008,1), end=c(2013,12), frequency=12)
```
```{r, results='hide', echo=FALSE}
#plot the value of companies in Chulwalar
plot(ChulwalarIndex, main="Chulwalar Index")

#take a look and see if there is any correlation with the Etel Flower Exports
cor(TotalEtelAsIs, ChulwalarIndex)
cor(BlueEtelAsIs , ChulwalarIndex)
cor(RedEtelAsIs , ChulwalarIndex)
```

12. Month Inflation rate in Chulwalar - there is a negative correlation (-0.08378282) between inflation and the exports of the Etel flower.  The negative correlation is seen with the export of the Red Etel flower (-0.0982151) but not the Blue Etel flower (0.02117817).
```{r, echo=FALSE}
# Monthly Inflation rate in Chulwalar 
InflationVector <- c(ImportedIndicators[142:153,2],ImportedIndicators[142:153,3],ImportedIndicators[142:153,4],ImportedIndicators[142:153,5],ImportedIndicators[142:153,6],ImportedIndicators[142:153,7])
Inflation <- ts(InflationVector, start=c(2008,1), end=c(2013,12), frequency=12)
```
```{r, echo=FALSE}
#plot the monthly inflation in Chulwalar
plot(Inflation, main="Inflation")
```
```{r, results='hide', echo=FALSE}

#See if there is a correlation between Etel flower exports and inflation
cor(TotalEtelAsIs, Inflation)
cor(BlueEtelAsIs , Inflation)
cor(RedEtelAsIs , Inflation)
```

13. Monthly Producer Price Index for Etel in Chulwalar - - there is not a big enough correlatin (0.374707) to impact the exports of the Etel Flower.
```{r, results='hide',echo=FALSE}
# Monthly Producer Price Index (PPI) for Etel in Chulwalar
PPIEtelVector <- c(ImportedIndicators[114:125,2],ImportedIndicators[114:125,3],ImportedIndicators[114:125,4],ImportedIndicators[114:125,5],ImportedIndicators[114:125,6],ImportedIndicators[114:125,7])
PPIEtel <- ts(PPIEtelVector, start=c(2008,1), end=c(2013,12), frequency=12)
plot(PPIEtel, main="PPIEtel")
```
```{r, results='hide',echo=FALSE}
cor(TotalEtelAsIs, PPIEtel)
cor(BlueEtelAsIs , PPIEtel)
cor(RedEtelAsIs , PPIEtel)
```

14. Influence National Holidays. This indicator looks at the months leading up to a National holiday to see if exports increase - there is a moderate correlation (0.4535836), but not sure this will help with forecasting future exports
```{r, echo=FALSE}

# This indicator is an experiment where the influence of National Holidays is 
# extended into the months leading up to the holiday. 
# However later tests show that this indicator is no better for forecasting than the
# orignial National Holidays indicator.    
InfluenceNationalHolidaysVector <- c(ImportedIndicators[184:195,2],ImportedIndicators[184:195,3],ImportedIndicators[184:195,4],ImportedIndicators[184:195,5],ImportedIndicators[184:195,6],ImportedIndicators[184:195,7])
InfluenceNationalHolidays <- ts(InfluenceNationalHolidaysVector, start=c(2008,1), end=c(2013,12), frequency=12)
```
```{r, echo=FALSE}
plot(InfluenceNationalHolidays, main="InfluenceNationalHolidays")
```
```{r, results='hide', echo=FALSE}
cor(TotalEtelAsIs, InfluenceNationalHolidays)
cor(BlueEtelAsIs , InfluenceNationalHolidays)
cor(RedEtelAsIs , InfluenceNationalHolidays)
```


##View correlation between exports and external indicators by offsetting the export data by one month. 

The purpose of offsetting the export data by one month is to see if the index change makes itself first noticeable on exports in the following months.

External Satisfaction Index indicator is to be offset by one month, to see if the index change makes itself first noticeable on exports in the following months.


```{r, echo=FALSE}
#Overall Satisfaction
SIGovVector <- c(ImportedIndicators[16:27,2],ImportedIndicators[16:27,3],ImportedIndicators[16:27,4],ImportedIndicators[16:27,5],ImportedIndicators[16:27,6],ImportedIndicators[16:27,7])
SIGov <- ts(SIGovVector , start=c(2008,1), end=c(2013,12), frequency=12)

SIExternOffsetByOneMonthVector <- c(ImportedIndicators[57:68,2],ImportedIndicators[57:68,3],ImportedIndicators[57:68,4],ImportedIndicators[57:68,5],ImportedIndicators[57:68,6],ImportedIndicators[57:68,7])
SIExternOffsetByOneMonth <- ts(SIGovVector, start=c(2008,1), end=c(2013,11), frequency=12)
```
```{r, results='hide',echo=FALSE}
#plot the 
plot(SIExternOffsetByOneMonth, main="Satisfaction Indicator offset by One month", ylab="Satisfaction Indicator offset by one month")
```

December 2013 was deleted from the data set to see what impact this month has on the Etel Flower exports.

The satisfaction index indicator now has a negative correlation with the Etel Flower Exports - -0.004445279 but this still isn't enough to have a noticeable impact.

```{r, echo=FALSE}
# Delete December 2013 from the ts
TotalAsIsWithoutDec12013 <- ts(TotalAsIsVector , start=c(2008,1), end=c(2013,11), frequency=12)
TotalEtelAsIsWithoutDec12013 <- ts(TotalEtelAsIsVector, start=c(2008,1), end=c(2013,11), frequency=12)
BlueEtelAsIsWithoutDec12013  <- ts(BlueEtelAsIsVector, start=c(2008,1), end=c(2013,11), frequency=12)
RedEtelAsIsWithoutDec12013 <- ts(RedEtelAsIsVector, start=c(2008,1), end=c(2013,11), frequency=12)
```
``` {r, results='hide', echo=FALSE}
#check the correlation of removing December 2013
cor(TotalEtelAsIsWithoutDec12013, SIExternOffsetByOneMonth)
cor(BlueEtelAsIsWithoutDec12013 , SIExternOffsetByOneMonth)
cor(RedEtelAsIsWithoutDec12013, SIExternOffsetByOneMonth)
TotalAsIsWithoutDec2013_lm <- lm(TotalAsIsWithoutDec12013 ~ SIExternOffsetByOneMonth, data=TotalAsIsWithoutDec12013)
summary(TotalAsIsWithoutDec2013_lm)
```


November and December 2013 were removed to see the overall impact on exports of Etel Flowers.  The impact is minimal with a correlation of 0.0446355.

```{r, echo=FALSE}
#Look at the Government party indicator
SIGovVectorShifted2Months <- c(ImportedIndicators[15:26,2],ImportedIndicators[15:26,3],ImportedIndicators[15:26,4],ImportedIndicators[15:26,5],ImportedIndicators[15:26,6],ImportedIndicators[15:26,7])
SIGovShifted2Months <- ts(SIGovVectorShifted2Months , start=c(2008,1), end=c(2013,10), frequency=12)
```
```{r, results='hide', echo=FALSE}
plot(SIGovShifted2Months)
```

November and December 2013 were removed from the Time Series data set to see if it shows any impact to the overall export of the Etel flowers.  Again, there is a minimal impact with a correlation of 0.0446355.
```{r, echo=FALSE}
# Delete November and December 2013 from the ts
TotalAsIsWithoutNovDec2013 <- ts(TotalAsIsVector , start=c(2008,1), end=c(2013,10), frequency=12)
TotalEtelAsIsWithoutNovDec2013 <- ts(TotalEtelAsIsVector, start=c(2008,1), end=c(2013,10), frequency=12)
BlueEtelAsIsWithoutNovDec2013 <- ts(BlueEtelAsIsVector, start=c(2008,1), end=c(2013,10), frequency=12)
RedEtelAsIsWithoutNovDec2013 <- ts(RedEtelAsIsVector, start=c(2008,1), end=c(2013,10), frequency=12)
```
```{r, results='hide', echo=FALSE}
#check to see if there is a correlation
cor(TotalAsIsWithoutNovDec2013, SIGovShifted2Months)

cor(TotalEtelAsIsWithoutNovDec2013, SIGovShifted2Months)
cor(BlueEtelAsIsWithoutNovDec2013, SIGovShifted2Months)
cor(RedEtelAsIsWithoutNovDec2013, SIGovShifted2Months)
TotalAsIsWithoutNovDec2013_lm <- lm(TotalAsIsWithoutNovDec2013 ~ SIGovShifted2Months, data=TotalAsIsWithoutNovDec2013)
summary(TotalAsIsWithoutNovDec2013)
```

The overall satisifcation and Government Party indicators also did not have any impact on the overall exports of the Etel flowers.

``` {r, echo=FALSE}
#Check to see if there is a correlation between removing November and December for the Government indicator - there is none
TotalEtelAsIsWithoutNovDec2013 <- ts(TotalEtelAsIsVector, start=c(2008,1), end=c(2013,10), frequency=12)
BlueEtelAsIsWithoutNovDec2013 <- ts(BlueEtelAsIsVector, start=c(2008,1), end=c(2013,10), frequency=12)
RedEtelAsIsWithoutNovDec2013 <- ts(RedEtelAsIsVector, start=c(2008,1), end=c(2013,10), frequency=12)
```
```{r, results='hide', echo=FALSE}
cor(TotalEtelAsIsWithoutNovDec2013, SIGovShifted2Months)
cor(BlueEtelAsIsWithoutNovDec2013, SIGovShifted2Months)
cor(RedEtelAsIsWithoutNovDec2013, SIGovShifted2Months)
```
Each of the external indicators were reviewed to see which ones should be included in the final model.

```{r, echo=FALSE}
# Proposed spending for Independence day presents
IndependenceDayPresentsVector <- c(ImportedIndicators[156:167,2],ImportedIndicators[156:167,3],ImportedIndicators[156:167,4],ImportedIndicators[156:167,5],ImportedIndicators[156:167,6],ImportedIndicators[156:167,7])
IndependenceDayPresents <- ts(IndependenceDayPresentsVector, start=c(2008,1), end=c(2013,12), frequency=12)
# Yearly number of Globalisation Party members in Chulwalar
GlobalisationPartyMembersVector <- c(ImportedIndicators[86:97,2],ImportedIndicators[86:97,3],ImportedIndicators[86:97,4],ImportedIndicators[86:97,5],ImportedIndicators[86:97,6],ImportedIndicators[86:97,7])
GlobalisationPartyMembers <- ts(GlobalisationPartyMembersVector, start=c(2008,1), end=c(2013,12), frequency=12)
UrbanoExportsVector <- c(ImportedIndicators[72:83,2],ImportedIndicators[72:83,3],ImportedIndicators[72:83,4],ImportedIndicators[72:83,5],ImportedIndicators[72:83,6],ImportedIndicators[72:83,7])
UrbanoExports <- ts(UrbanoExportsVector, start=c(2008,1), end=c(2013,12), frequency=12)
CEPIVector <- c(ImportedIndicators[2:13,2],ImportedIndicators[2:13,3],ImportedIndicators[2:13,4],ImportedIndicators[2:13,5],ImportedIndicators[2:13,6],ImportedIndicators[2:13,7])
CEPI <- ts(CEPIVector , start=c(2008,1), end=c(2013,12), frequency=12)
TemperatureVector <- c(ImportedIndicators[30:41,2],ImportedIndicators[30:41,3],ImportedIndicators[30:41,4],ImportedIndicators[30:41,5],ImportedIndicators[30:41,6],ImportedIndicators[30:41,7])
Temperature <- ts(TemperatureVector, start=c(2008,1), end=c(2013,12), frequency=12)
BirthsVector <- c(ImportedIndicators[44:55,2],ImportedIndicators[44:55,3],ImportedIndicators[44:55,4],ImportedIndicators[44:55,5],ImportedIndicators[44:55,6],ImportedIndicators[44:55,7])
Births <- ts(BirthsVector, start=c(2008,1), end=c(2013,12), frequency=12)
IndicatorsMatrix <-cbind(CEPIVector, SIGovVector, TemperatureVector, BirthsVector, SIGovVector, UrbanoExportsVector, GlobalisationPartyMembersVector, AEPIVector, PPIEtel, NationalHolidaysVector, ChulwalarIndexVector, InflationVector, IndependenceDayPresentsVector)

```
```{r, results='hide',echo=FALSE}

# Establish the standardised data matrix

IndicatorsmatrixStandardised=scale(IndicatorsMatrix)
IndicatorsmatrixStandardised

# The dimensions of the matrix are determined by the number of indicators.
NumberOfIndicators=dim(IndicatorsmatrixStandardised)[1]
NumberOfIndicators

# Produce the IndicatorsCorrelationCoefficientMatrix.
IndicatorsCorrelationCoefficientMatrix=(1/(NumberOfIndicators-1))*t(IndicatorsmatrixStandardised)%*%IndicatorsmatrixStandardised
IndicatorsCorrelationCoefficientMatrix
```

The Correlation Coefficient Matrix shows that CEPI has a high correlation with Overall Satisfication, Urbano Exports, Global Party Members and Average Export Price Index. These will become the set of indicators used later, although there is a risk of multicollinearity.

National Holidays, Urbano Exports, Global Party Members have a very low correlation with one another. Therefore these will also  become a set of indicators used later.

##Building Forecasting Model: using all external indicators with the Etel Flower Exports


```{r, echo=FALSE}
# Monthly Satisfaction Index (SI) external index 
SIExternVector <- c(ImportedIndicators[58:69,2],ImportedIndicators[58:69,3],ImportedIndicators[58:69,4],ImportedIndicators[58:69,5],ImportedIndicators[58:69,6],ImportedIndicators[58:69,7])
SIExtern <- ts(SIExternVector, start=c(2008,1), end=c(2013,12), frequency=12)
# All Indiators in one model:
ModelWithAlllIndicators_AllEtel <- tslm(TotalEtelAsIs ~ trend + season + CEPI + SIGov + Temperature + Births + SIExtern + UrbanoExports + GlobalisationPartyMembers + AEPI + PPIEtel + NationalHolidays + ChulwalarIndex + Inflation + IndependenceDayPresents)
ModelWithAlllIndicators_BlueEtel <- tslm(BlueEtelAsIs ~ trend + season + CEPI + SIGov + Temperature + Births + SIExtern + UrbanoExports + GlobalisationPartyMembers + AEPI + PPIEtel + NationalHolidays + ChulwalarIndex + Inflation + IndependenceDayPresents)
ModelWithAlllIndicators_RedEtel <- tslm(RedEtelAsIs ~ trend + season + CEPI + SIGov + Temperature + Births + SIExtern + UrbanoExports + GlobalisationPartyMembers + AEPI + PPIEtel + NationalHolidays + ChulwalarIndex + Inflation + IndependenceDayPresents)
```

```{r, results='hide',echo=FALSE}
##all Etel flowers
summary(ModelWithAlllIndicators_AllEtel)
```
Combining Chulwalar Export Price Index (CEPI), Satisfaction Index - Government, Temperatur, Births, Overall Satisfaction Index, Urbano Exports, Globalisation Party Members, Average Export Price Index, National Holidays, Chulwalar Index, Inflation, and Independence Day presents into one model did not produce any statistically signifcant p-values for any of the external indicators.  This indicates that having all the external indicators in one model is not the best model to use for forecasting.


```{r, results='hide', echo=FALSE}
#Blue Etel Flower Exports:
summary(ModelWithAlllIndicators_BlueEtel)
```



```{r,results='hide',echo=FALSE}
#Red Etel Flower Exports:
summary(ModelWithAlllIndicators_RedEtel)
```




##Build Model with the Chulwaler Export Price Index indicator and the Etel Flower Exports

```{r, results='hide', echo=FALSE}
ModelWithCEPI <- tslm(TotalEtelAsIs ~ trend + season + CEPI)
summary(ModelWithCEPI)    
```

The Adjusted R Squared is at 0.866 which is good but the Chulwaler Export Price Index does not appear to have a statistical impact on the export of the Etel Flowers based on the p-values of the indicator.

##Build Model with the Statisfaction Index to view its impact on the Etel Flower Exports
```{r}

# The Satisfaction Index (gov)  hardly changes the function of the model.
ModelWithSIGov <- tslm(TotalEtelAsIs ~ trend + season + SIGov)
summary(ModelWithSIGov)    
```

The Satisification Index - Government does seem to have  statistical significant impact on the Etel flower exports.  The p-value is 0.0284 for the Satisification Index - Government and the R-squared is 0.8767.

##Build Model with the Temperature indicator and its impact on the Etel Flower Exports

```{r, results='hide',echo=FALSE}
# Temperature:
ModelWithTemperature <- tslm(TotalEtelAsIs ~ trend + season + Temperature)
VIF(tslm(TotalEtelAsIs ~ trend + season + Temperature))
summary(ModelWithTemperature)

ModelWithTemperature_Blue <- tslm(BlueEtelAsIs ~ trend + season + Temperature)
summary(ModelWithTemperature_Blue)

ModelWithTemperature_Red <- tslm(RedEtelAsIs ~ trend + season + Temperature)
summary(ModelWithTemperature_Red)
```

The temperature indicator does not do a good job impacting the overall export of the Etel flowers.  The Variance inflation factor is 9.40994 and the p-value is 0.196136.

##Build Model with National Holidays indicator to review its impact on the Etel flower exports

```{r, results='hide',echo=FALSE}
#Natinal Holiday Indicator
#all etel flower exports
ModelWithNationalHolidays <- tslm(TotalEtelAsIs ~ trend + season + NationalHolidays)
VIF(tslm(TotalEtelAsIs ~ trend + season + NationalHolidays))
#only blue etel flower exports
ModelWithNationalHolidays_Blue <- tslm(BlueEtelAsIs ~ trend + season + NationalHolidays)
#only red etel flower exports
ModelWithNationalHolidays_Red <- tslm(RedEtelAsIs ~ trend + season + NationalHolidays)
```

```{r, results='hide',echo=FALSE}
summary(ModelWithNationalHolidays)
```

National Holidays have some impact on the export of Etel Flowers.  The Adjusted R Squared is 0.8744 and the p-value 0.0534 for the National Holiday indicator is somewhat statistically significant. The variance inflation factor is high at 9.74823 but this indicator may still be used in the final model.


```{r, results='hide', echo=FALSE}
summary(ModelWithNationalHolidays_Blue)
```

```{r, results='hide', echo=FALSE}
summary(ModelWithNationalHolidays_Red)
```


##Build Model with inflation indicator to review its impact on the Etel flower exports

Inflation does not have a statistical impact on the exports of Etel flowers as indicated by the p-value 0.563331 and the variance inflation factor of 9.487.  Therefore, the inflation indicator is not a good factor to include in the final model.

```{r, results='hide',echo=FALSE}
# Inflation:
ModelWithInflation <- tslm(TotalEtelAsIs ~ trend + season + Inflation)
VIF(tslm(TotalEtelAsIs ~ trend + season + Inflation))
#only blue etel flower exports
ModelWithInflation_Blue <- tslm(BlueEtelAsIs ~ trend + season + Inflation)
#Only red etel flower exports
ModelWithInflation_Red <- tslm(RedEtelAsIs ~ trend + season + Inflation)
```

```{r, results='hide', echo=FALSE}
#Summary of all etel flower exports
#summary(ModelWithInflation)
```

```{r, results=='hide', echo=FALSE}
#Summary of blue etel flower exports
#summary(ModelWithInflation_Blue)
```

```{r, results='hide', echo=FALSE}
#Summary of red etel flower exports
#summary(ModelWithInflation_Red)
```

##Build Model with Independence Day Presents indicator to review its impact on the Etel flower exports

The buying of Independence Day presents does not have a statistical impact on the exports of Etel flowers as indicated by the p-value 0.574184 and the variance inflation factor of 12.15354.  Therefore, the buying of Independence Day present indicator is not a good factor to include in the final model.
```{r, results='hide',echo=FALSE}
# IndependenceDayPresents:
ModelWithIndependenceDayPresents <- tslm(TotalAsIs ~ trend + season + IndependenceDayPresents)
VIF(tslm(TotalAsIs ~ trend + season + IndependenceDayPresents))
summary(ModelWithIndependenceDayPresents)
```


##Build Model with National Holiday indicator to review its impact on the Etel flower exports

```{r, results='hide',echo=FALSE}
# InfluenceNationalHolidays:
# Indicator with the best adjusted R square. The months remain very significant and the indicator

ModelWithInfluenceNationalHolidays <- tslm(TotalEtelAsIs ~ trend + season + InfluenceNationalHolidays)
VIF(tslm(TotalEtelAsIs ~ trend + season + InfluenceNationalHolidays))
#Blue Etel Flower
ModelWithInfluenceNationalHolidays_Blue <- tslm(BlueEtelAsIs ~ trend + season + InfluenceNationalHolidays)
#Red Etel Flower
ModelWithInfluenceNationalHolidays_Red <- tslm(RedEtelAsIs ~ trend + season + InfluenceNationalHolidays)
```

The Influence National Holiday indicator has more of an effect on the Red Etel flower export than on the Blue Etel flower.  The adjusted Adjusted R Square is 0.8744 and the p-value for the indicator is 0.05336 which is mildly signifcant. The variation inflation factor for the total Etel flower exports is 9.74823.
```{r, results='hide', echo=FALSE}
#All Etel Flower exports
summary(ModelWithInfluenceNationalHolidays)
```


```{r, results='hide', echo=FALSE}

#Blue Etel Flower Exports
summary(ModelWithInfluenceNationalHolidays_Blue)
```

```{r, results='hide', echo=FALSE}

#Red Etel Flower Exports
summary(ModelWithInfluenceNationalHolidays_Red)
```

#Building Models with High Correlating Indicators

```{r, results='hide',echo=FALSE}
IndicatorsCorrelationCoefficientMatrix
ModelWithHighCorrelatingIndicators <- tslm(TotalEtelAsIs ~ trend + season + CEPI + SIExtern + UrbanoExports + GlobalisationPartyMembers + AEPI)
ModelWithHighCorrelatingIndicators_2 <- tslm(TotalEtelAsIs ~ trend + season + CEPI +  UrbanoExports)
VIF(tslm(TotalEtelAsIs ~ trend+season+CEPI+UrbanoExports , data = TotalEtelAsIs))
```
```{r, results='hide',echo=FALSE}
summary(ModelWithHighCorrelatingIndicators)
summary(ModelWithHighCorrelatingIndicators_2)
```

High correlating indicators do not show a strong impact on the export of Etel flowers.  The adjusted R Square is 0.8706 but the p-values for each of the indicators is not statistically significant.

#Building Models with Low Correlating Indicators

```{r, results='hide',echo=FALSE}
IndicatorsCorrelationCoefficientMatrix
ModelWithLowCorrelatingIndicators <- tslm(TotalEtelAsIs ~ trend + season + NationalHolidays +  GlobalisationPartyMembers)
VIF(tslm(TotalEtelAsIs ~ trend + season + NationalHolidays +  GlobalisationPartyMembers))
```
```{r, results='hide', echo=FALSE}
summary(ModelWithLowCorrelatingIndicators) 
```

The low correlating indicators chosen were the National Holiday and the Globalization of Party Members.  Both seem to have an impact on the exports of the Etel flowers.  The adjusted R Square is 0.883 and both p-values for the indicators are statistically significant (National Holiday - 0.0457 and Globalization of Party Members - 0.0256). The variance inflation factor is 10.64726 which is high and an indicator this is not the best model.

#Building Model with Trend and Season only and no other external indicators

```{r, echo=FALSE}
ModelWithTrendAndSeasonalityOnly <- tslm(TotalEtelAsIs ~ trend + season)
summary(ModelWithTrendAndSeasonalityOnly)
```

The seasonality and trend model is a fair model.  The adjusted R Square is 0.8683 and the p-values for some of the seasons are statistically signifcant but not all.  Mainly season 11.


#Building Model without Trend and seasonality.

This model does not work well. The adjusted R square is 0.0728 and none of the p-values for the external indicators are of statisitical significance.

```{r, echo=FALSE}
ModelWithoutTrendAndSeasonality <- tslm(TotalEtelAsIs ~ CEPI + SIExtern + UrbanoExports + GlobalisationPartyMembers + AEPI)
summary(ModelWithoutTrendAndSeasonality)
```
#Etel Flower Export Model
 The model for the etel segment, including both subcategories, work best with trend and seasonality. An attempt to improve the model by adding Temperature showed no improvement worth mentioning.  The adjusted R Square for the total Etel flower exports is 0.863.  Not all seasons for the Red Etel flower are statistically significant but season 10 and 11 are.  The Blue Etel flower does not show the same improvement.

```{r, echo=FALSE, results='hide'}

# The model for the etel segment, including both subcategories, work best with trend and seasonality. An attempt 
# to improve the model by adding Temperature showed no improvement worth mentioning.  
ModelTotalEtel <- tslm(TotalEtelAsIs~ trend + season)
summary(ModelTotalEtel)


ModelBlueEtel <- tslm(BlueEtelAsIs  ~ trend + season)
summary(ModelBlueEtel)


ModelRedEtel <- tslm(RedEtelAsIs  ~ trend + season)
summary(ModelRedEtel)
```
#Forecasting with Models with Shorten Time series

The time series data sets require that the time be shorten in order to compare the produced forecasts with the 
current As Is data.

```{r, echo=FALSE}
TotalEtelAsIs_2012 <- ts(TotalEtelAsIsVector, start=c(2008,1), end=c(2012,12), frequency=12)
BlueEtelAsIs_2012 <- ts(BlueEtelAsIsVector, start=c(2008,1), end=c(2012,12), frequency=12)
RedEtelAsIs_2012 <- ts(RedEtelAsIsVector, start=c(2008,1), end=c(2012,12), frequency=12)

# Shortening the indicators by the same amount

CEPI_2012 <- ts(CEPIVector , start=c(2008,1), end=c(2012,12), frequency=12)
SIGov_2012 <- ts(SIGovVector , start=c(2008,1), end=c(2012,12), frequency=12)
Temperature_2012 <- ts(TemperatureVector, start=c(2008,1), end=c(2012,12), frequency=12)
Births_2012 <- ts(BirthsVector, start=c(2008,1), end=c(2012,12), frequency=12)
SIExtern_2012 <- ts(SIExternVector, start=c(2008,1), end=c(2012,12), frequency=12)
UrbanoExports_2012 <- ts(UrbanoExportsVector, start=c(2008,1), end=c(2012,12), frequency=12)
GlobalisationPartyMembers_2012 <- ts(GlobalisationPartyMembersVector, start=c(2008,1), end=c(2012,12), frequency=12)
AEPI_2012 <- ts(AEPIVector, start=c(2008,1), end=c(2012,12), frequency=12)
PPIEtel_2012 <- ts(PPIEtel, start=c(2008,1), end=c(2012,12), frequency=12)
NationalHolidays_2012 <- ts(NationalHolidaysVector, start=c(2008,1), end=c(2012,12), frequency=12)
ChulwalarIndex_2012 <- ts(ChulwalarIndexVector, start=c(2008,1), end=c(2012,12), frequency=12)
Inflation_2012 <- ts(InflationVector, start=c(2008,1), end=c(2012,12), frequency=12)
InfluenceNationalHolidays_2012 <- ts(InfluenceNationalHolidaysVector, start=c(2008,1), end=c(2012,12), frequency=12)

# Seperate the As Is and Plan data for 2013 in order to be able to compare the forecast to this data.
TotalEtelAsIsVector_2013 <- c(ImportedAsIsData [44:55,7])
BlueEtelAsIsVector_2013 <- c(ImportedAsIsData [58:69,7])
RedEtelAsIsVector_2013 <- c(ImportedAsIsData [72:83,7])

TotalEtelAsIs_2013 <- ts(TotalEtelAsIsVector_2013, start=c(2013,1), end=c(2013,12), frequency=12)
BlueEtelAsIs_2013 <- ts(BlueEtelAsIsVector_2013, start=c(2013,1), end=c(2013,12), frequency=12)
RedEtelAsIs_2013 <- ts(RedEtelAsIsVector_2013, start=c(2013,1), end=c(2013,12), frequency=12)

TotalEtelPlanVector_2013 <- c(ImportedPlanData[44:55,7])
BlueEtelPlanVector_2013 <- c(ImportedPlanData[58:69,7])
RedEtelPlanVector_2013 <- c(ImportedPlanData[72:83,7])

TotalEtelPlan_2013 <- ts(TotalEtelPlanVector_2013, start=c(2013,1), end=c(2013,12), frequency=12)
BlueEtelPlan_2013 <- ts(BlueEtelPlanVector_2013, start=c(2013,1), end=c(2013,12), frequency=12)
RedEtelPlan_2013 <- ts(RedEtelPlanVector_2013, start=c(2013,1), end=c(2013,12), frequency=12)

# Seperate the indicator data for 2013 and 2014 in order to use these in the forecasts. First as a vector and then as a time series.

CEPIVector_2013 <- c(ImportedIndicators[2:13,7])
CEPIVector_2014 <- c(ImportedIndicators[2:13,8])
SIGovVector_2013 <- c(ImportedIndicators[16:27,7])
SIGovVector_2014 <- c(ImportedIndicators[16:27,8])
TemperatureVector_2013 <- c(ImportedIndicators[30:41,7])
TemperatureVector_2014 <- c(ImportedIndicators[30:41,8])
BirthsVector_2013 <- c(ImportedIndicators[44:55,7])
BirthsVector_2014 <- c(ImportedIndicators[44:55,8])
SIExternVector_2013 <- c(ImportedIndicators[58:69,7])
SIExternVector_2014 <- c(ImportedIndicators[58:69,8])
UrbanoExportsVector_2013 <- c(ImportedIndicators[72:83,7])
UrbanoExportsVector_2014 <- c(ImportedIndicators[72:83,8])
GlobalisationPartyMembersVector_2013 <- c(ImportedIndicators[86:97,7])
GlobalisationPartyMembersVector_2014 <- c(ImportedIndicators[86:97,8])
AEPIVector_2013 <- c(ImportedIndicators[100:111,7])
AEPIVector_2014 <- c(ImportedIndicators[100:111,8])
PPIEtelVector_2013 <- c(ImportedIndicators[114:125,7])
PPIEtelVector_2014 <- c(ImportedIndicators[114:125,8])
NationalHolidaysVector_2013 <-c(ImportedIndicators[170:181,7])
NationalHolidaysVector_2014 <-c(ImportedIndicators[170:181,8])
ChulwalarIndexVector_2013 <- c(ImportedIndicators[128:139,7])
ChulwalarIndexVector_2014 <- c(ImportedIndicators[128:139,8])
InflationVector_2013 <- c(ImportedIndicators[142:153,7])
InflationVector_2014 <- c(ImportedIndicators[142:153,8])
InfluenceNationalHolidaysVector_2013 <-c(ImportedIndicators[184:195,7])
InfluenceNationalHolidaysVector_2014 <-c(ImportedIndicators[184:195,8])

CEPI_2013 <- ts(CEPIVector_2013 , start=c(2013,1), end=c(2013,12), frequency=12)
CEPI_2014 <- ts(CEPIVector_2014 , start=c(2013,1), end=c(2013,12), frequency=12)
SIGov_2013 <- ts(SIGovVector_2013 , start=c(2013,1), end=c(2013,12), frequency=12)
SIGov_2014 <- ts(SIGovVector_2014 , start=c(2013,1), end=c(2013,12), frequency=12)
Temperature_2013 <- ts(TemperatureVector_2013, start=c(2013,1), end=c(2013,12), frequency=12)
Temperature_2014 <- ts(TemperatureVector_2014, start=c(2013,1), end=c(2013,12), frequency=12)
Births_2013 <- ts(BirthsVector_2013, start=c(2013,1), end=c(2013,12), frequency=12)
Births_2014 <- ts(BirthsVector_2014, start=c(2013,1), end=c(2013,12), frequency=12)
SIExtern_2013 <- ts(SIExternVector_2013, start=c(2013,1), end=c(2013,12), frequency=12)
SIExtern_2014 <- ts(SIExternVector_2014, start=c(2013,1), end=c(2013,12), frequency=12)
UrbanoExports_2013 <- ts(UrbanoExportsVector_2013, start=c(2013,1), end=c(2013,12), frequency=12)
UrbanoExports_2014 <- ts(UrbanoExportsVector_2014, start=c(2013,1), end=c(2013,12), frequency=12)
GlobalisationPartyMembers_2013 <- ts(GlobalisationPartyMembersVector_2013, start=c(2013,1), end=c(2013,12), frequency=12)
GlobalisationPartyMembers_2014 <- ts(GlobalisationPartyMembersVector_2014, start=c(2013,1), end=c(2013,12), frequency=12)
AEPI_2013 <- ts(AEPIVector_2013, start=c(2013,1), end=c(2013,12), frequency=12)
AEPI_2014 <- ts(AEPIVector_2013, start=c(2013,1), end=c(2013,12), frequency=12)
PPIEtel_2013 <- ts(PPIEtelVector_2013, start=c(2013,1), end=c(2013,12), frequency=12)
PPIEtel_2014 <- ts(PPIEtelVector_2014, start=c(2013,1), end=c(2013,12), frequency=12)
NationalHolidays_2013 <- ts(NationalHolidaysVector_2013, start=c(2013,1), end=c(2013,12), frequency=12)
NationalHolidays_2014 <- ts(NationalHolidaysVector_2014, start=c(2014,1), end=c(2014,12), frequency=12)
ChulwalarIndex_2013 <- ts(ChulwalarIndexVector_2013, start=c(2013,1), end=c(2013,12), frequency=12)
ChulwalarIndex_2014 <- ts(ChulwalarIndexVector_2014, start=c(2013,1), end=c(2013,12), frequency=12)
Inflation_2013 <- ts(InflationVector_2013, start=c(2013,1), end=c(2013,12), frequency=12)
Inflation_2014 <- ts(InflationVector_2014, start=c(2013,1), end=c(2013,12), frequency=12)
InfluenceNationalHolidaysVector_2013 <- ts(InfluenceNationalHolidaysVector_2013, start=c(2013,1), end=c(2013,12), frequency=12)
InfluenceNationalHolidaysVector_2014 <- ts(InfluenceNationalHolidaysVector_2014, start=c(2013,1), end=c(2013,12), frequency=12)
```

##Check High Correlating Indicators

The same results as seen in the previous models is present with this model.  The adjusted R Square is 0.8778 but none of the p-values for the external indicators are statistically significant.
```{r, echo=FALSE, results='hide'}
ModelWithHighCorrelatingIndicators_2012 <- tslm(TotalEtelAsIs_2012 ~ trend + season + CEPI_2012 + SIExtern_2012 + UrbanoExports_2012 + GlobalisationPartyMembers_2012 + AEPI_2012)
summary(ModelWithHighCorrelatingIndicators_2012) 
```
### Adding data to the 2013 indicator values in order to forecast
```{r, echo=FALSE}
# Add "newdata" to the 2013 indicator values for the forecast 
ModelWithHighCorrelatingIndicators_Forecast <- forecast(ModelWithHighCorrelatingIndicators_2012,newdata=data.frame(CEPI_2012=CEPI_2013, SIExtern_2012=SIExtern_2013, UrbanoExports_2012= UrbanoExports_2013, GlobalisationPartyMembers_2012=GlobalisationPartyMembers_2013, AEPI_2012=AEPI_2013),h=12)
plot(ModelWithHighCorrelatingIndicators_Forecast, main="High Correlating Indicators Forecast")
#ModelWithHighCorrelatingIndicators_Forecast
```
```{r, results='hide',echo=FALSE}
# In order to be able to correlate the Forecast with the As Is Data, it is necessary to convert the Point 
# Estimator into a time series. 
ModelWithHighCorrelatingIndicators_Forecast_df <-as.data.frame(ModelWithHighCorrelatingIndicators_Forecast) 
ModelWithHighCorrelatingIndicators_PointForecast <- ts(ModelWithHighCorrelatingIndicators_Forecast_df$"Point Forecast", start=c(2013,1), end=c(2013,12), frequency=12)
```
``` {r, results='hide',echo=FALSE}
# Correlation of the forecasts and As Is Data. As a comparison, the correlation of the As Is Data for 2013 with the Plan Data. 
cor(ModelWithHighCorrelatingIndicators_PointForecast, TotalEtelAsIs_2013) 
cor(TotalEtelAsIs_2013, TotalEtelPlan_2013)
```

There is a strong correlation between the As is data and the plan data for 2013 for the Etel Flower Exports. The Linear regression comparison supports the results with an adjusted R Square of 0.9144.

```{r, echo=FALSE, results='hide'}
# A Comparison with linear regression also supports the result.
ModelWithHighCorrelatingIndicators_forecast_lm <- lm(TotalEtelAsIs_2013 ~ ModelWithHighCorrelatingIndicators_PointForecast, data = TotalEtelAsIs_2013)
TotalEtelAsIs_2013_lm <- lm(TotalEtelAsIs_2013 ~ TotalEtelPlan_2013, data = TotalEtelAsIs_2013)
summary(ModelWithHighCorrelatingIndicators_forecast_lm)
summary(TotalEtelAsIs_2013_lm)
```
##Check Low Correlating Indicators

The adjusted R square is 0.8786 but none of the external indicators have a p-value of statistical significance.
```{r, echo=FALSE, results='hide'}
# Shorten ModelWithLowCorrelatingIndicators by one year in order to be able to produce a forecast for 2013. 
ModelWithLowCorrelatingIndicators_2012 <- tslm(TotalEtelAsIs_2012 ~ trend + season + NationalHolidays_2012 + UrbanoExports_2012 + GlobalisationPartyMembers_2012)
summary(ModelWithLowCorrelatingIndicators_2012) 
```

### Adding data to the 2013 Low correlating indicator values in order to forecast

The low correlating indicators forecast model follows the pattern of the existing data for the Etel Flower exports. The linear regression comparsion supports this forecasting model. The adjusted R square is 0.9144 and the F-statistic is 118.5,

``` {r, echo=FALSE, results='hide'}
# Add "newdata" to the 2013 indicator values for the forecast 
ModelWithLowCorrelatingIndicators_Forecast <- forecast(ModelWithLowCorrelatingIndicators_2012,newdata=data.frame(NationalHolidays_2012=NationalHolidays_2013, UrbanoExports_2012= UrbanoExports_2013, GlobalisationPartyMembers_2012=GlobalisationPartyMembers_2013),h=12)
plot(ModelWithLowCorrelatingIndicators_Forecast, main="Low Correlating Indicators Forecast")
ModelWithLowCorrelatingIndicators_Forecast
```

``` {r, echo=FALSE, results='hide'}
# In order to be able to correlate the Forecast with the As Is Data, it is necessary to convert the Point 
# Estimator into a time series. 
ModelWithLowCorrelatingIndicators_Forecast_df <-as.data.frame(ModelWithLowCorrelatingIndicators_Forecast) 
ModelWithLowCorrelatingIndicators_PointForecast <- ts(ModelWithLowCorrelatingIndicators_Forecast_df$"Point Forecast", start=c(2013,1), end=c(2013,12), frequency=12)

# Correlation of the forecasts and As Is Data. As a comparison, the correlation of the As Is Data for 2013 with the Plan Data. 
cor(ModelWithLowCorrelatingIndicators_PointForecast, TotalEtelAsIs_2013) 
cor(TotalEtelAsIs_2013, TotalEtelPlan_2013)

# A Comparison with linear regression also supports the result.
ModelWithLowCorrelatingIndicators_forecast_lm <- lm(TotalEtelAsIs_2013 ~ ModelWithLowCorrelatingIndicators_PointForecast, data = TotalEtelAsIs_2013)
TotalEtelAsIs_2013_lm <- lm(TotalEtelAsIs_2013 ~ TotalEtelPlan_2013, data = TotalEtelAsIs_2013)
summary(ModelWithLowCorrelatingIndicators_forecast_lm)
summary(TotalEtelAsIs_2013_lm)
```

There is a strong correlation with the low correlating indicators and the current as is data for 2013 and the plan data for 2013 for the Etel Flower exports.

##Forcasting with only Seasonality and Trend for the Etel Flower Exports

The seasonality and trend work well with this forecasting model.  The adjust R Square is 0.8755 and again season 10 and 11 show statistical significance. 

```{r, echo=FALSE, results='hide'}
# Shorten ModelWithTrendAndSeasonalityOnly by one year in order to be able to produce a forecast for 2013.
ModelWithTrendAndSeasonalityOnly_2012 <- tslm(TotalEtelAsIs_2012 ~ trend + season)
summary(ModelWithTrendAndSeasonalityOnly_2012) 
```

### Adding data to the 2013 Seasonality and Trend for the Forecast model

``` {r, echo=FALSE}
# Add "newdata" to the 2013 indicator values for the forecast.
ModelWithTrendAndSeasonalityOnly_Forecast <- forecast(ModelWithTrendAndSeasonalityOnly_2012,h=12)
plot(ModelWithTrendAndSeasonalityOnly_Forecast, main="Trend And Seasonality Only Forecast")
#ModelWithTrendAndSeasonalityOnly_Forecast
```

Trend and Seasonality continue to be the best model for the Etel Flower exports.  The forecasting model shows a pattern that follows even closer to the current export pattern of the Etel flower.  There is a strong correlation between the current export Etel flower data and the plan data for 2013.  The linear regression supports this model. The adjusted R Square is 0.9144 and the F-Statistic is 118.5

``` {r, echo=FALSE, results='hide'}
# In order to be able to correlate the Forecast with the As Is Data, it is necessary to convert the Point 
# Estimator into a time series. 
ModelWithTrendAndSeasonalityOnly_Forecast_df <-as.data.frame(ModelWithTrendAndSeasonalityOnly_Forecast) 
ModelWithTrendAndSeasonalityOnly_PointForecast <- ts(ModelWithTrendAndSeasonalityOnly_Forecast_df$"Point Forecast", start=c(2013,1), end=c(2013,12), frequency=12)

# Correlation of the forecasts and As Is Data. As a comparison, the correlation of the As Is Data for 2013 with the Plan Data.
cor(ModelWithTrendAndSeasonalityOnly_PointForecast, TotalEtelAsIs_2013) 
cor(TotalEtelAsIs_2013, TotalEtelPlan_2013)

# A Comparison with linear regression also supports the result.
ModelWithTrendAndSeasonalityOnly_Forecast_lm <- lm(TotalEtelAsIs_2013 ~ ModelWithTrendAndSeasonalityOnly_PointForecast, data = TotalEtelAsIs_2013)
TotalEtelAsIs_2013_2013_lm <- lm(TotalEtelAsIs_2013 ~ TotalEtelPlan_2013, data = TotalEtelAsIs_2013)
summary(ModelWithTrendAndSeasonalityOnly_Forecast_lm)
summary(TotalEtelAsIs_2013_2013_lm)
```

``` {r, echo=FALSE, results='hide'}
# Shorten the variables in ModelTotalEtel by one year in order to be able to produce a forecast for 2013.
ModelTotalEtel_2012 <- tslm(TotalEtelAsIs_2012 ~ trend + season)
ModelBlueEtel_2012 <- tslm(BlueEtelAsIs_2012 ~ trend + season)
ModelRedEtel_2012 <- tslm(RedEtelAsIs_2012 ~ trend + season)
summary(ModelTotalEtel_2012) 
summary(ModelBlueEtel_2012) 
summary(ModelRedEtel_2012) 

# Forecast
ModelTotalEtel_Forecast <- forecast(ModelTotalEtel_2012,h=12)
ModelBlueEtel_Forecast <- forecast(ModelBlueEtel_2012,h=12)
ModelRedEtel_Forecast <- forecast(ModelRedEtel_2012,h=12)

```


``` {r, echo=FALSE}
plot(ModelTotalEtel_Forecast,main="Total Etel Flower Forecast")
```



``` {r, echo=FALSE}
plot(ModelBlueEtel_Forecast,main="Blue Etel Flower Forecast")
```



```{r, echo=FALSE}
plot(ModelRedEtel_Forecast,main="Red Etel Flower Forecast")
```
```{r, echo=FALSE, results='hide'}
ModelTotalEtel_Forecast
ModelBlueEtel_Forecast
ModelRedEtel_Forecast
```

#Forecasting 2014 for the Etel Flower Exports with National Holidays and Globalisation Party Members

In looking at 2014 Forecasting of the Etel Flower exports, National Holidays and Globalisation Party Member seem to have a positive impact on the total exports of the Etel Flowers. The p-values are 0.04566 for National Holidays indicator and 0.02557 for Globalisation Party Members indicator both statistically significant.

```{r, echo=FALSE}
# As ModelWithLowCorrelatingIndicators was the one of best fitting model for a forecast, the exports data for 2014 will be forecast
# based on trend and seasonality and NationalHolidays, UrbanoExports and GlobalisationPartyMembers. 
summary(ModelWithLowCorrelatingIndicators) 
Forecast_ModelWithLowCorrelatingIndicators_2014 <- forecast(ModelWithLowCorrelatingIndicators,newdata=data.frame(NationalHolidays=NationalHolidays_2014, UrbanoExports= UrbanoExports_2014, GlobalisationPartyMembers=GlobalisationPartyMembers_2014),h=12)
plot(Forecast_ModelWithLowCorrelatingIndicators_2014, main="Forecast- With Indicators_2014")
```
``` {r, echo=FALSE, results='hide'}
Forecast_ModelWithLowCorrelatingIndicators_2014_df <-as.data.frame(Forecast_ModelWithLowCorrelatingIndicators_2014) 
PointForecast_ModelWithLowCorrelatingIndicators_2014 <- ts(Forecast_ModelWithLowCorrelatingIndicators_2014_df$"Point Forecast", start=c(2014,1), end=c(2014,12), frequency=12)
PointForecast_ModelWithLowCorrelatingIndicators_2014

cor(TotalAsIs_2014,TotalPlan_2014)
cor(TotalAsIs_2014,PointForecast_ModelWithLowCorrelatingIndicators_2014)
```

#Forecasting Exports for the Etel Flowers with Seasonality and Trend only for 2014

Seasonality and Trend continue to show a good fit and work well with forecasting for 2014.  The adjusted R Square is 0.8683.  With this forecast model though Season 10 statistical significance is much lower but Season 11 continues to show statistically signifcance in the Etel flower exports for Chuluwala.  

There continues to be a strong correlation between the current export data and the plan data.

```{r, echo=FALSE}
# As ModelWithTrendAndSeasonalityOnly also gave a well fitting model for a forecast, the exports data for 2014 will be forecast
# based on trend and seasonality. 
summary(ModelWithTrendAndSeasonalityOnly) 
Forecast_2014 <- forecast(ModelWithTrendAndSeasonalityOnly,h=12)
plot(Forecast_2014, main="Forecast with Seasonality and Trend 2014")
```
```{r, echo=FALSE, results='hide'}

Forecast_2014_df <-as.data.frame(Forecast_2014) 
PointForecast_TrendAndSeasonality_2014 <- ts(Forecast_2014_df$"Point Forecast", start=c(2014,1), end=c(2014,12), frequency=12)
PointForecast_TrendAndSeasonality_2014

cor(TotalAsIs_2014,TotalPlan_2014)
cor(TotalAsIs_2014,PointForecast_TrendAndSeasonality_2014)
```

#Using other Modelling Approaches

##Exponential Smoothing

The Exponential Smoothing does not seem to be the best model for forecasting 2014.  The predicted forecast shows flat exports for th Etel Flower which is not indictive of past years.


``` {r, echo=FALSE}
# Formula: ses(). It must be decided if alpha (the smoothing parameter
# should be automatically calculated. If initial=simple, the alpha value can 
# be set to any chosen value, if initial=optimal (or nothing, as this is the 
# default), alpha will be set to the optimal value based on ets().
# h=12 gives the number of cycles for the forecast.

Model_ses <- ses(TotalEtelAsIs, h=12)
summary(Model_ses)
plot(Model_ses)

# The Akaike's Information Criterion(AIC/AICc) or the Bayesian Information 
# Criterion (BIC) should be at minimum.

plot(Model_ses, plot.conf=FALSE, ylab="Etel Flower Exports for Chulwalar", xlab="Year", main="", fcol="white", type="o")
lines(fitted(Model_ses), col="green", type="o")
lines(Model_ses$mean, col="blue", type="o")
legend("topleft",lty=1, col=c(1,"green"), c("data", expression(alpha == 0.671)),pch=1)
```

##Holt's linear trend method

The Holt's Linear Trend Method does not seem to be the best model for forecasting 2014.  The predicted forecast shows a relatively flat forecast for exports for th Etel Flower which is not indictive of past years.

```{r, echo=FALSE, results='hide'}
# Holt added to the model in order to forecast using trends as well.
# For this it is necessary to add a beta, which determines the trend.
# If neither alpha nor beta is stated, both parameters will be optimised
# using ets(). 

Model_holt_1 <- holt(TotalEtelAsIs,h=12)
summary(Model_holt_1)
plot(Model_holt_1)

# The trend is exponential if the intercepts(level) and the gradient (slope) are
# multiplied with eachother. The values are worse. As the Beta was very low in 
# the optimisation, the forecast is very similar to the ses() model. 


Model_holt_2<- holt(TotalEtelAsIs, exponential=TRUE,h=12)
summary(Model_holt_2)
plot(Model_holt_2)

# As such simple trends tend to forecast the future to positively, we have added
# a dampener.
# Similar values to that of Model_holt_1 

Model_holt_3 <- holt(TotalEtelAsIs, damped=TRUE,h=12)
summary(Model_holt_3)
plot(Model_holt_3)

# This also works for exponential trends. 
# The values remain worse. 

Model_holt_4 <- holt(TotalEtelAsIs, exponential=TRUE, damped=TRUE,h=12)
summary(Model_holt_4)
plot(Model_holt_4)


# level and slope can be plotted individually for each model. 
plot(Model_holt_1$model$state, main="Holt Model State 1")
plot(Model_holt_2$model$state, main="Holt Model State 2")
plot(Model_holt_3$model$state, main="Holt Model State 3")
plot(Model_holt_4$model$state, main="Holt Model State 4")
```
```{r, echo=FALSE}

plot(Model_holt_1, plot.conf=FALSE, ylab="Etel Flower Exports for Chulwalar", xlab="Year", main="", fcol="white", type="o")
lines(fitted(Model_ses), col="purple", type="o")
lines(fitted(Model_holt_1), col="blue", type="o")
lines(fitted(Model_holt_2), col="red", type="o")
lines(fitted(Model_holt_3), col="green", type="o")
lines(fitted(Model_holt_4), col="orange", type="o")
lines(Model_ses$mean, col="purple", type="o")
lines(Model_holt_1$mean, col="blue", type="o")
lines(Model_holt_2$mean, col="red", type="o")
lines(Model_holt_3$mean, col="green", type="o")
lines(Model_holt_4$mean, col="orange", type="o")
legend("topleft",lty=1, col=c(1,"purple","blue","red","green","orange"), c("data", "SES","Holts auto", "Exponential", "Additive Damped", "Multiplicative Damped"),pch=1)

```


Holt's auto seems to have the best forecast for the Etel flower exports in 2014.

##Holt-Winter's seasonal method

The AIC is better than the regular Holts Method and the forecast for 201 Etel flower exports follow trends from past years exports.

``` {r, echo=FALSE, resuls='hide'}
# Holt and Winters have expanded Holt's model further to include the
# seasonality aspect. The parameter gamma, which is for smoothing the
# seasonality, was added to achieve this. The values are better than 
# the models without seasonality. This logical matches our results from the regression approaches, 
# the data is strongly influenced by seasonality. 
# In the following model, none of the parameters are given so that they
# will be optimised automatically. There are two models: one using
# an additive error model method and one using a multiplicative error model.

Model_hw_1 <- hw(TotalEtelAsIs ,seasonal="additive",h=12)
summary(Model_hw_1)
plot(Model_hw_1)


Model_hw_2 <- hw(TotalEtelAsIs ,seasonal="multiplicative",h=12)
summary(Model_hw_2)
plot(Model_hw_2)
```

The additive model gives slightly better results than the multiplicative model.

``` {r, echo=FALSE}
#plotting additive model versus multiplicative model
plot(Model_hw_1, ylab="Exports Chulwalar  ", plot.conf=FALSE, type="o", fcol="white", xlab="Year")
lines(fitted(Model_hw_1), col="red", lty=2)
lines(fitted(Model_hw_2), col="green", lty=2)
lines(Model_hw_1$mean, type="o", col="red")
lines(Model_hw_2$mean, type="o", col="green")
legend("topleft",lty=1, pch=1, col=1:3, c("data","Holt Winters' Additive","Holt Winters' Multiplicative"))

```
```{r, echo=FALSE, results='hide'}
# In order to use the results later, they need to be converted into point forcasts.
Model_hw_1_df <-as.data.frame(Model_hw_1) 
Model_hw_1_PointForecast <- ts(Model_hw_1_df$"Point Forecast", start=c(2014,1), end=c(2014,12), frequency=12)
Model_hw_1_PointForecast
Model_hw_2_df <-as.data.frame(Model_hw_2) 
Model_hw_2_PointForecast <- ts(Model_hw_2_df$"Point Forecast", start=c(2014,1), end=c(2014,12), frequency=12)
Model_hw_2_PointForecast
```

##Innovations state space models for exponential smoothing 

```{r, echo=FALSE, results='hide'}
# The funktion ets() produces a model with the same values as Model_hw_1. 
# The reason for this is that all of the parameters in this model were optimised 
# using the ets() function. The results are a ets(A,A,A) model which is an 
# additive method for trend, seasonality and errors. The previous models
# also showed the type of ets() model in their summary. In this case the user
# parameters were either accepted or rejected. As the model has been set to 
# "ZZZ", the best model will be automatically chosen. 

Model_ets <-ets(TotalEtelAsIs, model="ZZZ", damped=NULL, alpha=NULL, beta=NULL, gamma=NULL, phi=NULL, additive.only=FALSE, lambda=NULL, lower=c(rep(0.0001,3), 0.8), upper=c(rep(0.9999,3),0.98), opt.crit=c("lik","amse","mse","sigma","mae"), nmse=3, bounds=c("both","usual","admissible"), ic=c("aicc","aic","bic"), restrict=TRUE)
summary(Model_ets)
```
```{r, echo=FALSE}

plot(Model_ets)
Model_ets_forecast <- forecast(Model_ets,h=12)
plot(Model_ets_forecast)
```
```{r, echo=FALSE, results='hide'}
# In order to use the results later, they need to be converted into point forcasts.
Model_ets_forecast_df <-as.data.frame(Model_ets_forecast) 
Model_ets_PointForecast <- ts(Model_ets_forecast_df$"Point Forecast", start=c(2014,1), end=c(2014,12), frequency=12)
Model_ets_PointForecast
```

##ARIMA Model

The data for the Etel Flower Export is stationary which is supported by the Augmented Dickey-Fuller Test, but there is a warning indicating the p-value is less than 0.01.

```{r, echo=FALSE}
### AR = Autoregression
# A Regression of a variable with itself. The autoregressive model specifies 
# that the output variable depends linearly on its own previous values.

### MA = Moving Average
# The rolling average of past forecast errors.
# This model should not be confused with moving average smoothing, which is used
# for establishing trends and is based on past values. 

### ARIMA = AutoRegressive Integrated Moving Average model
# A combination of Differencing, Autoregression and Moving Average.
# Integration is the opposite of differencing.

### Differencing
# In order to make the time series stationary, it is necessary to difference.
# Firstly, we need to check if the data are already stationary. This can be done
# with help of the Augmented Dickey-Fuller Test
adf.test(TotalEtelAsIs, alternative = "stationary")
```

The Kwiatkowki=Phillips-Schmidt-Shin Test supports that the p-value is ate 0.1822 , which is statistically significant.
``` {r, echo=FALSE}

# Another possibility is the Kwiatkowski-Phillips-Schmidt-Shin Test
kpss.test(TotalEtelAsIs)

# This test swaps the hypothesis so that a low p-value means that it
# is necessary to difference. The p-value here is under 0,01 and a warning
# is shown.
```

The data is differenced and retested

```{r, echo=FALSE}
# As the test failed to deliver a clear result, the data will be differenced 
# and then retested. 

ChulwalarDiff <- diff(TotalEtelAsIs)

adf.test(ChulwalarDiff, alternative = "stationary")
kpss.test(ChulwalarDiff)

tsdisplay(ChulwalarDiff)
```

The following test method is used to distinguish the number of "normal" differencing rounds and seasonal differencing rounds.  Seasonal differencing is used for data that is dominated by seasonality which Etel Flower exports seem to be.  A lag as been added to the time series data for the Etel Flower data.

```{r, echo=FALSE}
# The folling is a test method to distinguish the number of "normal" 
# differencing rounds and seasonal differencing rounds. 
# Seasonal differencing is used for data which is dominated by seasonality.
# The time series has been assigned a lag.

ns <- nsdiffs(TotalEtelAsIs)
if(ns > 0) {
  xstar <- diff(TotalEtelAsIs,lag=frequency(TotalEtelAsIs),differences=ns)
} else {
  xstar <- TotalEtelAsIs
}
nd <- ndiffs(xstar)
if(nd > 0) {
  xstar <- diff(xstar,differences=nd)
}

nd # Number of normal differencing rounds
ns # Number of seasonal differencing rounds
xstar # The output "xstar" has been differenced correctly. 
tsdisplay(xstar)

# If "lag" is set to 12, this is equivalent to 1* seasonal differencing
ChulwalarDiff_lag <- diff(TotalEtelAsIs,lag=12)

adf.test(ChulwalarDiff_lag, alternative = "stationary")
kpss.test(ChulwalarDiff_lag)

tsdisplay(ChulwalarDiff)
tsdisplay(ChulwalarDiff_lag)

plot(ChulwalarDiff)
lines(ChulwalarDiff_lag, col="red") 
```

##ARIMA modelling	

``` {r, echo=FALSE}
# The values for AIC, AICc and BIC should be minimised.
# We wil try a range of combinations.

# R uses the maximum likelihood estimation (MLE) in order to decide how good
# a certain model is. The parameters, which give the most likely model based on the given data, are chosen.
# Furthermore, R gives the log-likelihood, which should be maximised. 

Model_ARIMA_1  <- Arima(TotalEtelAsIs, order=c(0,1,0))
summary(Model_ARIMA_1 )
plot(forecast(Model_ARIMA_1 ))


Model_ARIMA_2 <- Arima(TotalEtelAsIs, order=c(1,1,0))
summary(Model_ARIMA_2)
plot(forecast(Model_ARIMA_2))


Model_ARIMA_3 <- Arima(TotalEtelAsIs, order=c(1,1,1))
summary(Model_ARIMA_3)
plot(forecast(Model_ARIMA_3))


Model_ARIMA_4 <- Arima(TotalEtelAsIs, order=c(2,1,1))
summary(Model_ARIMA_4)
plot(forecast(Model_ARIMA_4))


Model_ARIMA_5 <- Arima(TotalEtelAsIs, order=c(2,1,2))
summary(Model_ARIMA_5)
plot(forecast(Model_ARIMA_5))


Model_ARIMA_6 <- Arima(TotalEtelAsIs, order=c(3,1,2))
summary(Model_ARIMA_6)
plot(forecast(Model_ARIMA_6))

Model_ARIMA_7 <- Arima(TotalEtelAsIs, order=c(3,1,3))
summary(Model_ARIMA_7)
plot(forecast(Model_ARIMA_7))


Model_ARIMA_8 <- Arima(TotalEtelAsIs, order=c(3,1,1))
summary(Model_ARIMA_8)
plot(forecast(Model_ARIMA_8))


Model_ARIMA_9 <- Arima(TotalEtelAsIs, order=c(3,1,2))
summary(Model_ARIMA_9)
plot(forecast(Model_ARIMA_9))


Model_ARIMA_10 <- Arima(TotalEtelAsIs, order=c(1,1,3))
summary(Model_ARIMA_10)
plot(forecast(Model_ARIMA_10))


Model_ARIMA_11 <- Arima(TotalEtelAsIs, order=c(2,1,3))
summary(Model_ARIMA_11)
plot(forecast(Model_ARIMA_11))


Model_ARIMA_12 <- Arima(TotalEtelAsIs, order=c(2,2,3))
summary(Model_ARIMA_12)
plot(forecast(Model_ARIMA_12))


Model_ARIMA_13 <- Arima(TotalEtelAsIs, order=c(2,3,2))
summary(Model_ARIMA_13)
plot(forecast(Model_ARIMA_13))


```

Based on the LFung-Box test below the data is not independently distributed because the p-value is 2.19 which gives enough evidence to reject the null hypothesis that the data is independently distributed.

``` {r, echo=FALSE}
Acf(residuals(Model_ARIMA_12))
Box.test(residuals(Model_ARIMA_12), lag=12, fitdf=4, type="Ljung")
# The Ljung-Box Test has H0: The data are independently distributed 
# und Ha: The data are not independently distributed. 

# Just like the remainder showed before, there is a definite coherence# 

```

##Seasonal ARIMA modelling  

The more the seasonal aspect is changed, the better the results based on AIC, AICc and BIC. Theoretically the models should more and more suitable for the forecast. However, a look at the plot of the forecasts shows that the changes are making the data less and less convincing and thus unuseable. 


``` {r, echo=FALSE}
# This model integrates the seasonal aspect into the ARIMA model. As the previous
# models all had a peak in lag 12, it seems viable that the data are seasonal. 

Model_Seasonal_ARIMA_0 <- Arima(TotalEtelAsIs, order=c(0,0,0), seasonal=c(1,0,0))
tsdisplay(residuals(Model_Seasonal_ARIMA_0))
summary(Model_Seasonal_ARIMA_0)


Model_Seasonal_ARIMA_1 <- Arima(TotalEtelAsIs, order=c(0,1,1), seasonal=c(0,1,1))
summary(Model_Seasonal_ARIMA_1)
plot(forecast(Model_Seasonal_ARIMA_1))


# Insert the values from the previous chapter for the non-seasonal values. 
Model_Seasonal_ARIMA_2 <- Arima(TotalEtelAsIs, order=c(2,3,2), seasonal=c(1,1,1))
tsdisplay(residuals(Model_Seasonal_ARIMA_2))
summary(Model_Seasonal_ARIMA_2)
plot(forecast(Model_Seasonal_ARIMA_2))


# Good results when using drift.
Model_Seasonal_ARIMA_3 <- Arima(TotalEtelAsIs, order=c(1,0,1), seasonal=c(1,1,1),include.drift=TRUE)
tsdisplay(residuals(Model_Seasonal_ARIMA_3))
summary(Model_Seasonal_ARIMA_3)
plot(forecast(Model_Seasonal_ARIMA_3))


#Model_Seasonal_ARIMA_4 <- Arima(TotalEtelAsIs, order=c(2,3,2), seasonal=c(1,3,2))
#tsdisplay(residuals(Model_Seasonal_ARIMA_4))
#summary(Model_Seasonal_ARIMA_4)
#plot(forecast(Model_Seasonal_ARIMA_4))

# The stronger the seasonality is differenced, the better the results are. However the 
# plot shows that the data are being increasingly changed. 

Model_Seasonal_ARIMA_5 <- Arima(TotalEtelAsIs, order=c(2,3,2), seasonal=c(1,4,2))
tsdisplay(residuals(Model_Seasonal_ARIMA_5))
summary(Model_Seasonal_ARIMA_5)
plot(forecast(Model_Seasonal_ARIMA_5))

```

##Auto-ARIMA modelling	
``` {r, echo=FALSE}
Model_auto.arima <- auto.arima(TotalEtelAsIs)
summary(Model_auto.arima)
CV(ModelWithTrendAndSeasonalityOnly)

Acf(residuals(Model_auto.arima))
Box.test(residuals(Model_auto.arima), lag=12, fitdf=4, type="Ljung")
# The Ljung-Box Test has H0: The data are independently distributed 
# and Ha: The data are not independently distributed. The results show: White noise

Model_auto.arima_forecast <- forecast(Model_auto.arima,h=12)
plot(Model_auto.arima_forecast)
Model_auto.arima_forecast

Model_auto.arima_forecast_df <-as.data.frame(Model_auto.arima_forecast) 
Model_auto.arima_PointForecast <- ts(Model_auto.arima_forecast_df$"Point Forecast", start=c(2014,1), end=c(2014,12), frequency=12)
Model_auto.arima_PointForecast
```

##Dynamic regression models	

``` {r, echo=FALSE}
# Regression models are combined with ARIMA models on order to make sure that
# external factors are included and that the time series are not only forecasted 
# based on past values. A regression of the ARIMA errors should be aspired for. 

# We have to diffentiate, as the time series and the SIGov Indicator are not 
# stationary. So that a forecast can be produced, the indicator has to be lagged
# so that we have values for 2014. 

CEPI_lagged <- ts(c(rep(NA,12),CEPIVector),start=c(2008,1), end=c(2013,12), frequency=12)
CEPI_2014_lagged <- ts(CEPI_2013, start=c(2014,1), end=c(2014,12), frequency=12)

Model_dynreg <- Arima(TotalEtelAsIs, xreg=CEPI_lagged, order=c(2,2,0))
tsdisplay(arima.errors(Model_dynreg), main="ARIMA errors")
summary(Model_dynreg)

Model_dynreg_auto.arima <- auto.arima(TotalEtelAsIs, xreg=CEPI_lagged)
summary(Model_dynreg_auto.arima)
tsdisplay(arima.errors(Model_dynreg_auto.arima), main="ARIMA errors")
# ARIMA(2,0,1)(0,1,1)[12] with drift 
# AIC=1343.61   AICc=1345.76   BIC=1358.27


Acf(residuals(Model_dynreg_auto.arima))
Box.test(residuals(Model_dynreg_auto.arima), lag=12, fitdf=4, type="Ljung")
# The Ljung-Box Test has H0: The data are independently distributed 
# and Ha: The data are not independently distributed. The results show: 
# White noise

summary(Model_dynreg_auto.arima)
Model_dynreg_auto.arima_forecast <- forecast(Model_dynreg_auto.arima, xreg=CEPI_2014_lagged,h=12)
plot(Model_dynreg_auto.arima_forecast)
Model_dynreg_auto.arima_forecast

Model_dynreg_auto.arima_forecast_df <-as.data.frame(Model_dynreg_auto.arima_forecast) 
Model_dynreg_auto.arima_PointForecast <- ts(Model_dynreg_auto.arima_forecast_df$"Point Forecast", start=c(2014,1), end=c(2014,12), frequency=12)
Model_dynreg_auto.arima_PointForecast

```

#New Model

As trend and seasonality have been shown to forecast well on their own, we will add the new combination to trend and seasonality in order to try to improve the forecast. Inflation and NationalHolidays additional Seasonality and Trend only.


```{r, echo=FALSE}
# 1. Inflation and NationalHolidays
ModelWithInflationAndNationalHolidays <- tslm(TotalEtelAsIs ~ trend + season + Inflation + NationalHolidays)
summary(ModelWithInflationAndNationalHolidays)


# 2. Seasonality and Trend only (as comparison to 1.)
ModelWithTrendAndSeasonalityOnly <- tslm(TotalEtelAsIs  ~ trend + season)
summary(ModelWithTrendAndSeasonalityOnly)
```

The adjusted R square for the Inflation and National Holiday model is 0.8765 whereas the adjusted R Square for the Seasonality and Trend model is 0.8683.  The Inflation and National Holiday model seems to work a little better but inflation is not statistically signifcant with a p-value of 0.1636.

## Forecasting with the New Model

There is a very strong correlation between the new model and the forcast plan using the Inflation and National Holiday indicators.  

``` {r, echo=FALSE, results='hide'}
# Shorten ModelWithInflationAndNationalHolidays by one year in order to be able to produce a forecast for 2013. 
ModelWithInflationAndNationalHolidays_2012 <- tslm(TotalEtelAsIs_2012 ~ trend + season + Inflation_2012 + NationalHolidays_2012)
summary(ModelWithInflationAndNationalHolidays_2012) 
```
``` {r, echo=FALSE}

# Add "newdata" to the 2013 indicator values for the forecast 
ModelWithInflationAndNationalHolidays_Forecast <- forecast(ModelWithInflationAndNationalHolidays_2012,newdata=data.frame(Inflation_2012=Inflation_2013,NationalHolidays_2012=NationalHolidays_2013),h=12)
plot(ModelWithInflationAndNationalHolidays_Forecast, main="Inflation And National Holidays Forecast Model")
ModelWithInflationAndNationalHolidays_Forecast
```
```{r, echo=FALSE, results='hide'}

# In order to be able to correlate the Forecast with the As Is Data, it is necessary to convert the Point 
# Estimator into a time series. 
ModelWithInflationAndNationalHolidays_Forecast_df <-as.data.frame(ModelWithInflationAndNationalHolidays_Forecast) 
ModelWithInflationAndNationalHolidays_PointForecast <- ts(ModelWithInflationAndNationalHolidays_Forecast_df$"Point Forecast", start=c(2013,1), end=c(2013,12), frequency=12)

# Correlation of the forecasts and As Is Data. As a comparison, the correlation of the As Is Data for 2013 with the Plan data. 
cor(ModelWithInflationAndNationalHolidays_PointForecast, TotalEtelAsIs_2013) 
cor(TotalEtelAsIs_2013, TotalEtelPlan_2013)


# A comparison with linear regression also supports the result.
ModelWithInflationAndNationalHolidays_forecast_lm <- lm(TotalEtelAsIs_2013 ~ ModelWithInflationAndNationalHolidays_PointForecast, data = TotalEtelAsIs_2013)
TotalEtelAsIs_2013_lm <- lm(TotalEtelAsIs_2013 ~ TotalEtelPlan_2013, data = TotalEtelAsIs_2013)
summary(ModelWithInflationAndNationalHolidays_forecast_lm)
summary(TotalEtelAsIs_2013_lm)
```

##Trend and Seasonality only as benchmark    

```{r,echo=FALSE, results='hide'}

# Shorten ModelWithTrendAndSeasonalityOnly by one year in order to be able to produce a forecast for 2013.
ModelWithTrendAndSeasonalityOnly_2012 <- tslm(TotalEtelAsIs_2012 ~ trend + season)
summary(ModelWithTrendAndSeasonalityOnly_2012)
```
```{r, echo=FALSE}

# Add "newdata" to the 2013 indicator values for the forecast.
ModelWithTrendAndSeasonalityOnly_Forecast <- forecast(ModelWithTrendAndSeasonalityOnly_2012,h=12)
plot(ModelWithTrendAndSeasonalityOnly_Forecast, main="Trend And Seasonality Only Forecast Model")
ModelWithTrendAndSeasonalityOnly_Forecast
```
```{r, echo=FALSE, results='hide'}

# In order to be able to correlate the Forecast with the As Is Data, it is necessary to convert the point 
# estimator into a time series. 
ModelWithTrendAndSeasonalityOnly_Forecast_df <-as.data.frame(ModelWithTrendAndSeasonalityOnly_Forecast) 
ModelWithTrendAndSeasonalityOnly_PointForecast <- ts(ModelWithTrendAndSeasonalityOnly_Forecast_df$"Point Forecast", start=c(2013,1), end=c(2013,12), frequency=12)

# Correlation of the forecasts and As Is data. As a comparison, the correlation of the As Is Data for 2013 with the Plan data.
cor(ModelWithTrendAndSeasonalityOnly_PointForecast, TotalEtelAsIs_2013) 
cor(TotalEtelAsIs_2013, TotalEtelPlan_2013)

# A Comparison with linear regression also supports the result.
ModelWithTrendAndSeasonalityOnly_Forecast_lm <- lm(TotalEtelAsIs_2013 ~ ModelWithTrendAndSeasonalityOnly_PointForecast, data = TotalEtelAsIs_2013)
TotalEtelAsIs_2013_lm <- lm(TotalEtelAsIs_2013 ~ TotalEtelPlan_2013, data = TotalEtelAsIs_2013)
summary(ModelWithTrendAndSeasonalityOnly_Forecast_lm)
summary(TotalEtelAsIs_2013_lm)
```
##Forecasting 2014 with New Model

```{r, echo=FALSE, results='hide'}
summary(ModelWithInflationAndNationalHolidays)
Forecast_ModelWithInflationAndNationalHolidays_2014 <- forecast(ModelWithInflationAndNationalHolidays, newdata=data.frame(Inflation=Inflation_2014, NationalHolidays=NationalHolidays_2014),h=12)
```
```{r, echo=FALSE}
plot(Forecast_ModelWithInflationAndNationalHolidays_2014,main="Forecast Model With Inflation And National Holidays 2014")
```
```{r, results='hide', echo=FALSE}
Forecast_ModelWithInflationAndNationalHolidays_2014_df <-as.data.frame(Forecast_ModelWithInflationAndNationalHolidays_2014) 
Pointforecast_ModelWithInflationAndNationalHolidays_2014 <- ts(Forecast_ModelWithInflationAndNationalHolidays_2014_df$"Point Forecast", start=c(2014,1), end=c(2014,12), frequency=12)
Pointforecast_ModelWithInflationAndNationalHolidays_2014

TotalEtelAsIsVector <- c(ImportedAsIsData[2:13,8])
TotalEtelAsIsVector
TotalEtelAsIs_2014 <- ts(TotalEtelAsIsVector, start=c(2014,1), end=c(2014,12), frequency=12)
TotalEtelAsIs_2014
cor(TotalEtelAsIs_2014,Pointforecast_ModelWithInflationAndNationalHolidays_2014)
```

#Comparison of Models

```{r, echo=FALSE}
#plot(TotalEtelAsIs_2014, type="o")
#lines(Model_dynreg_auto.arima_PointForecast, type="o", col="green")
#lines(Model_auto.arima_PointForecast, type="o",col="blue")
#lines(Model_ets_PointForecast, type="o",col="red")
#lines(PointForecast_TrendAndSeasonality_2014, type="o",col="orange")
#lines(Pointforecast_ModelWithInflationAndNationalHolidays_2014, type="o",col="pink")
#lines(TotalPlan_2014, type="o",col="purple")
#legend("topleft",lty=1, pch=1, col=c(1,"purple","red","blue","green","orange","pink"), c("data","Budget","ets/Holt-Winters","ARIMA", "Dynamische Regression","tslm","kappa"))
```


When reviewing the correlation between the forecasting models - Model_dynreg_auto.arima_PointForecast Model has the highest correlation at 0.9534608.

```{r, results='hide', echo=FALSE}
cor(TotalEtelAsIs_2014,TotalPlan_2014)
# 0.9448221
cor(TotalEtelAsIs_2014,PointForecast_ModelWithLowCorrelatingIndicators_2014)
# 0.9178468
cor(TotalEtelAsIs_2014,PointForecast_TrendAndSeasonality_2014)
# 0.9349765
cor(TotalEtelAsIs_2014,Model_ets_PointForecast)
# 0.9311129
cor(TotalEtelAsIs_2014,Model_auto.arima_PointForecast)
# 0.9238591
cor(TotalEtelAsIs_2014,Model_dynreg_auto.arima_PointForecast)
# 0.9259971
cor(TotalEtelAsIs_2014,Pointforecast_ModelWithInflationAndNationalHolidays_2014)
# 0.917632
```



 Based on the percentual differences the Trend and Seasonality model works best to forecast for the Etel exports in 2014.

#Final Summary
 Even though some external indicators provided a high correlation and adjusted R square they did not provide a statistical impact on the Etel flower exports based on the examination of the p-value.  The Etel Flower exports seem to be most impacted by trend and seasonality of the growing season of the flowers, therefore the best models were those that only looked at trend and seasonality.  The Holt - Winter's family models performed well.
 